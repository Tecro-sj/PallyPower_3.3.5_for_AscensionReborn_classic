------------------------------------------------------------------------
r147 | Tecro | 2025-11-16 | v3.2.21r 
------------------------------------------------------------------------

Added Sanctified Blessings support with auto-buffing functionality

Feature: Sanctified Blessings Integration
- Added support for all four Sanctified Blessings (30-minute duration)
  * Sanctified Blessing of Wisdom (Spell ID: 1325894)
  * Sanctified Blessing of Might (Spell ID: 1325782)
  * Sanctified Blessing of Kings (Spell ID: 1325898)
  * Sanctified Blessing of Sanctuary (Spell ID: 1325899)
- Location: PallyPowerValues.lua

Feature: Enhanced Buff Detection System
- Extended IsBuffActive() to detect all three blessing variants: Normal, Greater, and Sanctified
- Updated GetBuffExpiration() to recognize Sanctified blessings as 30-minute buffs (same as Greater)
- Modified ScanClass() to include Sanctified blessings in buff verification
- Location: PallyPower.lua

Feature: Three-Tier Auto-Buff System
- Hotkey1 (Default: ,) - Casts Normal Blessings (30-minute duration)
- Hotkey2 (Default: CTRL-,) - Casts Greater Blessings (30-minute duration)
- Hotkey3 (Default: ALT-,) - Casts Sanctified Blessings (30-minute duration)
- Auto-button intelligently selects blessing tier based on active hotkey
- Location: PallyPower.lua

Feature: Raid-Wide Sanctified Buffing
- In Greater Blessing mode (all classes receive same buff), Hotkey3 now casts Sanctified Blessings
- Automatically targets player with lowest buff duration
- Applies raid-wide Sanctified blessing to entire group
- Location: PallyPower.lua

Feature: UI and Configuration
- Added Hotkey3 keybinding field to options panel
- Implemented English and German localization for new features
- Location: PallyPowerOptions.lua, locale files

Impact:
- Paladins can now use Sanctified Blessings through PallyPower's auto-buff system
- Three-tier hotkey system provides quick access to all blessing variants
- Raid buffing efficiency improved with automatic target selection
- Full integration with existing buff detection and expiration tracking

Total changes: 3 files changed, [estimated 80+] insertions(+)
Files: PallyPower.lua, PallyPowerValues.lua, PallyPowerOptions.lua, locale files

------------------------------------------------------------------------
  ------------------------------------------------------------------------
  r146 | Tecro | 2025-11-08 | Custom Build
  ------------------------------------------------------------------------

  Fixed critical buff synchronization and assignment bugs:

  Bug Fix 1: Buff synchronization - Hexadecimal encoding
  - Fixed buff rank/talent transmission between paladins
  - Changed encoding from decimal to hexadecimal format (consistent with aura encoding)
  - Fixed receiving loop to parse 4 buffs instead of 6
  - Prevents data corruption when rank/talent values exceed single digit
  - This fixes the issue where assistants couldn't see other paladins' skilled buffs (only saw default Wisdom/Might/Kings)
  - Location: PallyPower.lua:873, 1137-1144

  Bug Fix 2: Missing UI updates for assignments
  - Added UpdateLayout() calls to assignment message handlers (ASSIGN, NASSIGN, MASSIGN, AASSIGN)
  - Fixed issue where leader-assigned buffs were received but UI didn't update
  - Location: PallyPower.lua:1171, 1184, 1195, 1254

  Bug Fix 3: Refresh overwrites leader assignments
  - Leaders now ignore assignment data from other paladins' SELF messages
  - Prevents non-leader refresh from overwriting leader's assignments
  - Location: PallyPower.lua:1134-1160, 1223-1244

  Bug Fix 4: Delayed UI updates for button contents
  - Added ButtonsUpdate() calls to assignment handlers when assignment affects local player
  - UI now updates instantly (< 0.1s) instead of waiting up to 2 seconds
  - Location: PallyPower.lua:1172-1175, 1179-1197, 1208-1212, 1271-1275

  Bug Fix 5: Critical permission check logic error
  - Corrected permission checks to verify if SENDER is leader instead of receiver
  - Assignment messages from leaders were being blocked because receivers checked their own leader status
  - This completely broke assignment synchronization from leader to other paladins
  - Location: PallyPower.lua:1173-1193, 1195-1223, 1225-1246, 1298-1317

  Bug Fix 6: Incorrect leader detection method
  - Use CheckRaidLeader(sender) function instead of non-existent AllPallys[sender].leader flag
  - CheckRaidLeader() uses WoW API (GetRaidRosterInfo) to get current rank dynamically
  - Recognizes both Raid Leader (rank 2) and Raid Assistant (rank 1)
  - Location: Same as Bug Fix 5 (all four assignment handlers)

  Impact:
  - Buff capabilities (rank/talent) now sync correctly between paladins
  - Leaders and Assistants can successfully assign buffs to other paladins
  - Assignments appear instantly in receiving paladin's UI
  - Refresh no longer overwrites leader's assignments
  - Both Raid Leader and Raid Assistant are properly recognized

  Total changes: 1 file changed, 70 insertions(+), 13 deletions(-)
  File: PallyPower.lua
  
------------------------------------------------------------------------
------------------------------------------------------------------------
r145 r144 | tecro | 2025-10-17 | Custom Build
Changed layout selection "Standard" too default.
------------------------------------------------------------------------
r144 | tecro | 2025-10-15 | Custom Build
Changed paths:
   M /trunk/PallyPower.lua

Fixed raid leader permission system and UI synchronization:
- Fixed CanControl() to properly grant raid leaders permission to modify all paladin assignments
- Raid leaders can now change assignments for all paladins, not just those with Free Assignment enabled
- Added UpdateLayout() call after receiving SELF messages to ensure other paladins appear in the UI immediately
- Added UpdateLayout() call after receiving ASELF messages for consistency
- Fixed issue where other paladins would not appear in the assignment interface
- Ensured level 1 paladins without spells can still sync with other paladins
- Added debug commands: /ppd (show sync status) and /ppsync (force sync)
- CRITICAL FIX: Fixed CHAT_MSG_ADDON event handler to use WoW 3.3.5 arg1-arg4 globals instead of function parameters

This allows raid leaders to properly manage buff assignments for all paladins in the raid.
------------------------------------------------------------------------
r143 | aznamir | 2010-08-20 10:57:34 +0000 (Fri, 20 Aug 2010) | 1 line
Changed paths:
   A /tags/v3.2.20 (from /trunk:142)

Tagging as v3.2.20
------------------------------------------------------------------------
r141 | aznamir | 2010-07-20 23:34:09 +0000 (Tue, 20 Jul 2010) | 1 line
Changed paths:
   M /trunk/.pkgmeta
   M /trunk/embeds.xml

removed RosterLib references
------------------------------------------------------------------------
r139 | aznamir | 2010-07-20 23:27:34 +0000 (Tue, 20 Jul 2010) | 1 line
Changed paths:
   M /trunk/PallyPower.lua

improved pet class detection logic, corrected 'show when single' option
------------------------------------------------------------------------
